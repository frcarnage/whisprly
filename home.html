<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>User Home â€“ Whisprly</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { background: #111; color: #fff; font-family: sans-serif; padding: 20px; }
  button { background:#222;color:#40aae3;border:1px solid #40aae3; padding:6px 10px; border-radius:4px; cursor:pointer; }
</style>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js"></script>
</head>
<body>
<h1>User Home</h1>
<p>Welcome <span id="userEmail"></span>!</p>
<button id="logout">Sign out</button>
<script>
const firebaseConfig = {apiKey:"AIzaSyAG...",authDomain:"whisprly-5415a.firebaseapp.com",projectId:"whisprly-5415a"};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth(); const db = firebase.firestore();
auth.onAuthStateChanged(async u=>{
  if(!u){location.href="login.html";return;}
  const docSnap = await db.collection("users").doc(u.uid).get();
  if(!docSnap.exists || docSnap.data().role!=="user"){location.href="login.html";return;}
  document.getElementById("userEmail").textContent = u.email;
});
document.getElementById("logout").onclick=()=>auth.signOut().then(()=>location.href="login.html");
</script>
</body>
</html>
