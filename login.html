<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Login â€“ Whisprly</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body { background: #111; color: #fff; display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif; }
  .box { background: #1e1e1e; padding: 20px; border-radius: 8px; width: 280px; }
  input, button { width: 100%; margin-top: 10px; padding: 10px; border-radius: 4px; border: none; }
  input { background: #333; color: #fff; }
  button { background: #40aae3; color: #000; font-weight: bold; cursor: pointer; }
  .error { color: tomato; margin-top: 10px; font-size: 0.9rem; }
</style>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js"></script>
</head>
<body>
<div class="box">
  <h2>Login</h2>
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <div class="error" id="err"></div>
  <a href="signup.html" style="color:#40aae3;display:inline-block;margin-top:10px;">Sign Up</a>
</div>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyAGJntf2pacqzkhyvj7P80NsNQkSAGX29g",
  authDomain: "whisprly-5415a.firebaseapp.com",
  projectId: "whisprly-5415a",
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

async function login() {
  const email = email.value, pw = password.value;
  try {
    const cred = await auth.signInWithEmailAndPassword(email, pw);
    const docSnap = await db.collection("users").doc(cred.user.uid).get();
    if (docSnap.exists && docSnap.data().role === "admin") location.href = "admin-dashboard.html";
    else location.href = "home.html";
  } catch (e) { err.textContent = e.message; }
}
</script>
</body>
</html>
